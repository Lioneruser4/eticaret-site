<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SpeedHUD Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap');
        
        body { 
            background-color: #000; 
            color: #fff; 
            font-family: 'Orbitron', sans-serif; 
            margin: 0; 
            overflow: hidden; 
            transition: all 0.3s ease;
        }

        .speed-value {
            font-size: 35vw; /* Ekranın eninə görə avtomatik böyüyür */
            line-height: 0.8;
            letter-spacing: -5px;
            filter: drop-shadow(0 0 20px #3b82f6);
        }

        /* Ekran yan çevrildikdə daha böyük font */
        @media (orientation: landscape) {
            .speed-value { font-size: 45vh; }
        }

        /* Güzgü rejimi (Şüşəyə əks etdirmək üçün) */
        .mirror-mode {
            transform: scaleX(-1);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center">

    <div class="absolute top-4 left-0 right-0 px-6 flex justify-between items-center opacity-40 hover:opacity-100 transition">
        <div class="text-xs tracking-widest">
            <span id="dot" class="status-dot bg-red-600"></span>
            <span id="gps-status">GPS GÖZLƏNİLİR</span>
        </div>
        <button onclick="toggleMirror()" class="bg-white/10 px-4 py-2 rounded-lg text-[10px] border border-white/20">GÜZGÜ REJİMİ</button>
    </div>

    <div id="display-container" class="flex flex-col items-center justify-center select-none">
        <div id="speed" class="speed-value font-black italic">0</div>
        <div class="text-blue-500 text-2xl md:text-4xl font-bold tracking-[1rem] mt-4 uppercase">km/h</div>
    </div>

    <div class="absolute bottom-6 opacity-30">
        <span class="text-xs uppercase">Max Speed:</span>
        <span id="max-speed" class="text-lg font-bold">0</span>
    </div>

    <script>
        const speedEl = document.getElementById('speed');
        const maxSpeedEl = document.getElementById('max-speed');
        const statusText = document.getElementById('gps-status');
        const dot = document.getElementById('dot');
        const container = document.getElementById('display-container');

        let maxSpeed = 0;

        // GPS İzləmə funksiyası
        function initGPS() {
            if ("geolocation" in navigator) {
                navigator.geolocation.watchPosition(pos => {
                    // Sürəti anlıq m/s-dən km/h-a çeviririk
                    const rawSpeed = pos.coords.speed;
                    const kmh = rawSpeed && rawSpeed > 0.5 ? Math.round(rawSpeed * 3.6) : 0;
                    
                    // Ekranı yenilə
                    speedEl.innerText = kmh;
                    
                    // Maksimum sürət rekordu
                    if (kmh > maxSpeed) {
                        maxSpeed = kmh;
                        maxSpeedEl.innerText = maxSpeed;
                    }

                    // Statusu yenilə
                    statusText.innerText = "SİSTEM AKTİV";
                    dot.classList.replace('bg-red-600', 'bg-green-500');
                    dot.classList.add('animate-pulse');

                }, err => {
                    statusText.innerText = "GPS XƏTASI";
                    console.error(err);
                }, {
                    enableHighAccuracy: true, // Ən yüksək dəqiqlik (Avtomobil üçün vacibdir)
                    maximumAge: 0,            // Keşlənmiş məlumat istifadə etmə
                    timeout: 5000
                });
            } else {
                statusText.innerText = "GPS DƏSTƏKLƏNMİR";
            }
        }

        // Güzgü rejimi funksiyası (Landscape halında şüşəyə qoymaq üçün)
        function toggleMirror() {
            container.classList.toggle('mirror-mode');
        }

        // Ekranın sönməsini əngəlləmək (Wake Lock API)
        async function requestWakeLock() {
            try {
                if ('keepAwake' in screen || 'wakeLock' in navigator) {
                    await navigator.wakeLock.request('screen');
                }
            } catch (err) {
                console.log("Wake Lock aktivləşdirilə bilmədi.");
            }
        }

        // Başlat
        window.onload = () => {
            initGPS();
            requestWakeLock();
        };

        // İstifadədən asılı olaraq ekranın həmişə açıq qalması üçün klikləmə lazımdır
        document.body.addEventListener('click', () => {
            if (document.documentElement.requestFullscreen) {
                document.documentElement.requestFullscreen();
            }
            requestWakeLock();
        });
    </script>
</body>
</html>
