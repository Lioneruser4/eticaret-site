<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mamba Pub POS - Tam Menyu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        body { background-color: #020617; color: #f8fafc; font-family: 'Segoe UI', sans-serif; }
        .menu-item { transition: all 0.2s; border: 1px solid #1e293b; cursor: pointer; background: #0f172a; }
        .menu-item:hover { border-color: #ef4444; transform: translateY(-2px); }
        .active-table { background: #ef4444 !important; border-color: #f87171 !important; box-shadow: 0 0 15px rgba(239, 68, 68, 0.4); }
        .active-cat { background: #ef4444 !important; color: white !important; }
        .has-order { position: relative; }
        .has-order::after { content: ''; position: absolute; top: 4px; right: 4px; width: 8px; height: 8px; background: #22c55e; border-radius: 50%; }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <header class="bg-slate-900 p-3 border-b border-slate-800 flex justify-between items-center px-6">
        <h1 class="text-2xl font-black italic tracking-tighter text-white">MAMBA <span class="text-red-600">PUB</span></h1>
        <div id="clock" class="text-slate-400 font-mono font-bold">12:00:00</div>
    </header>

    <div id="table-nav" class="flex gap-2 p-3 bg-slate-900 border-b border-slate-800 justify-center overflow-x-auto">
        </div>

    <div class="flex flex-1 overflow-hidden">
        
        <div class="w-3/4 flex flex-col bg-slate-950/50">
            <div id="cat-nav" class="flex gap-2 p-4 overflow-x-auto custom-scroll border-b border-slate-800/50">
                <button onclick="changeCat('isti')" id="cat-isti" class="cat-btn px-5 py-2 bg-slate-800 rounded-full text-xs font-bold active-cat">İSTİ YEMƏKLƏR</button>
                <button onclick="changeCat('meze')" id="cat-meze" class="cat-btn px-5 py-2 bg-slate-800 rounded-full text-xs font-bold">PİVƏ MƏZƏLƏRİ</button>
                <button onclick="changeCat('ickiler')" id="cat-ickiler" class="cat-btn px-5 py-2 bg-slate-800 rounded-full text-xs font-bold">İÇKİLƏR</button>
                <button onclick="changeCat('setler')" id="cat-setler" class="cat-btn px-5 py-2 bg-slate-800 rounded-full text-xs font-bold">SETLƏR</button>
                <button onclick="changeCat('qelyan')" id="cat-qelyan" class="cat-btn px-5 py-2 bg-slate-800 rounded-full text-xs font-bold">QƏLYAN</button>
            </div>

            <div id="menu-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 p-4 overflow-y-auto custom-scroll">
                </div>
        </div>

        <div class="w-1/4 bg-slate-900 border-l border-slate-800 flex flex-col">
            <div class="p-4 border-b border-slate-800">
                <h2 id="active-table-title" class="text-xl font-black text-red-500 italic">MASA 1</h2>
            </div>

            <div id="order-items" class="flex-1 overflow-y-auto p-3 space-y-2 custom-scroll">
                </div>

            <div class="p-4 bg-slate-950 border-t border-slate-800">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-slate-500 font-bold text-xs uppercase">Cəmi:</span>
                    <span id="total-price" class="text-2xl font-mono font-black text-green-500">0.00 ₼</span>
                </div>
                <button onclick="showReceipt()" class="w-full bg-red-600 hover:bg-red-500 py-4 rounded-xl font-black text-white shadow-lg mb-2">HESABI ÇIXART</button>
                <button onclick="clearCurrentTable()" class="w-full text-slate-600 text-[10px] font-bold uppercase hover:text-white">Masanı Təmizlə</button>
            </div>
        </div>
    </div>

    <div id="receipt-modal" class="hidden fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4 backdrop-blur-sm">
        <div class="bg-white text-black p-6 w-full max-w-sm font-mono shadow-2xl rounded-sm animate__animated animate__zoomIn">
            <div class="text-center border-b-2 border-dashed border-gray-300 pb-3 mb-3">
                <h2 class="text-xl font-black">MAMBA PUB</h2>
                <p id="r-date" class="text-[10px] text-gray-500"></p>
                <p id="r-table" class="font-bold text-md mt-1 border border-black inline-block px-3"></p>
            </div>
            <div id="r-list" class="space-y-1 text-sm mb-4 max-h-60 overflow-y-auto"></div>
            <div class="border-t-2 border-black pt-3 flex justify-between font-black text-xl">
                <span>CƏMİ:</span>
                <span id="r-total"></span>
            </div>
            <button onclick="closeModal()" class="w-full mt-6 bg-black text-white py-3 font-bold rounded">BAĞLA</button>
        </div>
    </div>

    <script>
        const allMenu = {
            isti: [
                { name: 'Gürcü xəngəli', price: 0.80 }, { name: 'Yarpaq xəngəli', price: 6.00 },
                { name: 'Tabaka', price: 18.00 }, { name: 'Çığirtma', price: 18.00 },
                { name: 'Qovurma', price: 12.00 }, { name: 'Monastr toyuq', price: 12.00 },
                { name: 'Sardelka', price: 6.00 }, { name: 'KFC Kotlet', price: 9.00 }
            ],
            meze: [
                { name: 'Pivə 1.80m', price: 1.80 }, { name: 'Semiçka', price: 2.00 },
                { name: 'Turşu', price: 3.00 }, { name: 'Boğaz', price: 1.50 },
                { name: 'Cips', price: 3.00 }, { name: 'Pendir çubuqları', price: 6.00 },
                { name: 'Kartof fri', price: 3.00 }, { name: 'Nohud', price: 2.00 }
            ],
            ickiler: [
                { name: 'Xırdalan', price: 1.80 }, { name: 'Nzs', price: 1.30 },
                { name: 'Cola 1L', price: 3.00 }, { name: 'Bizon Böyük', price: 3.00 },
                { name: 'Redbull', price: 5.00 }, { name: 'Su 0.5L', price: 1.00 }
            ],
            setler: [
                { name: 'Səbət SET 1', price: 20.00 }, { name: 'SET 2', price: 25.00 },
                { name: 'SET 3', price: 30.00 }, { name: 'SET 4 (40 AZN)', price: 40.00 }
            ],
            qelyan: [
                { name: 'Çaşqa Qəlyan', price: 12.00 }, { name: 'Qreyfrut Qəlyan', price: 18.00 }
            ]
        };

        let activeTable = localStorage.getItem('mamba_active_table') || "1";
        let activeCat = "isti";
        let tables = JSON.parse(localStorage.getItem('mamba_tables')) || {
            "1": [], "2": [], "3": [], "4": [], "5": [], "6": [], "K1": []
        };

        function renderTableNav() {
            const nav = document.getElementById('table-nav');
            nav.innerHTML = Object.keys(tables).map(id => `
                <button onclick="masaSec('${id}')" id="btn-${id}" 
                    class="px-5 py-2 bg-slate-800 rounded-lg font-bold border border-slate-700 transition shrink-0 ${activeTable == id ? 'active-table' : ''} ${tables[id].length > 0 ? 'has-order' : ''}">
                    ${id === 'K1' ? 'KABİNET' : 'Masa ' + id}
                </button>
            `).join('');
        }

        function changeCat(cat) {
            activeCat = cat;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active-cat'));
            document.getElementById('cat-' + cat).classList.add('active-cat');
            renderMenu();
        }

        function renderMenu() {
            const grid = document.getElementById('menu-grid');
            grid.innerHTML = allMenu[activeCat].map(item => `
                <div onclick="addToTable('${item.name}', ${item.price})" class="menu-item p-4 rounded-xl animate__animated animate__fadeIn">
                    <div class="text-[9px] text-red-500 font-bold mb-1 uppercase tracking-widest">${activeCat}</div>
                    <div class="text-sm font-bold text-white h-10 leading-snug">${item.name}</div>
                    <div class="text-lg font-mono font-black text-green-500 mt-2">${item.price.toFixed(2)} ₼</div>
                </div>
            `).join('');
        }

        function masaSec(id) {
            activeTable = id;
            localStorage.setItem('mamba_active_table', id);
            renderTableNav();
            document.getElementById('active-table-title').innerText = id === 'K1' ? 'KABİNET' : 'MASA ' + id;
            updateDisplay();
        }

        function addToTable(name, price) {
            let table = tables[activeTable];
            let existing = table.find(i => i.name === name);
            if (existing) { existing.count++; } 
            else { table.push({ name, price, count: 1 }); }
            saveAndSync();
        }

        function updateDisplay() {
            const list = document.getElementById('order-items');
            const totalDisplay = document.getElementById('total-price');
            let items = tables[activeTable];
            let total = 0;

            list.innerHTML = items.length === 0 ? '<div class="text-slate-600 text-center mt-10 italic text-sm">Sifariş yoxdur</div>' : '';
            
            items.forEach((item, index) => {
                let itemTotal = item.price * item.count;
                total += itemTotal;
                list.innerHTML += `
                    <div class="bg-slate-800/60 p-3 rounded-lg border border-slate-700 animate__animated animate__fadeInRight">
                        <div class="flex justify-between items-center">
                            <span class="font-black text-red-500 mr-2">${item.count}x</span>
                            <span class="flex-1 font-bold text-xs">${item.name}</span>
                            <span class="font-mono text-green-400 font-bold ml-2">${itemTotal.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between items-center mt-2 border-t border-slate-700 pt-1">
                             <span class="text-[9px] text-slate-500 italic">Vahid: ${item.price.toFixed(2)} ₼</span>
                             <button onclick="removeFromTable(${index})" class="text-[9px] text-red-400 hover:text-red-200 uppercase font-bold">Sil</button>
                        </div>
                    </div>
                `;
            });
            totalDisplay.innerText = total.toFixed(2) + " ₼";
        }

        function removeFromTable(index) {
            tables[activeTable].splice(index, 1);
            saveAndSync();
        }

        function saveAndSync() {
            localStorage.setItem('mamba_tables', JSON.stringify(tables));
            updateDisplay();
            renderTableNav();
        }

        function clearCurrentTable() {
            if(confirm('Bu masanı sıfırlamaq istəyirsiniz?')) {
                tables[activeTable] = [];
                saveAndSync();
            }
        }

        function showReceipt() {
            let items = tables[activeTable];
            if (items.length === 0) return;
            let total = items.reduce((sum, i) => sum + (i.price * i.count), 0);
            
            document.getElementById('r-list').innerHTML = items.map(i => `
                <div class="flex justify-between border-b border-gray-100 py-1">
                    <span>${i.count} x ${i.name}</span>
                    <span>${(i.price * i.count).toFixed(2)}</span>
                </div>
            `).join('');

            document.getElementById('r-date').innerText = new Date().toLocaleString('az-AZ');
            document.getElementById('r-table').innerText = activeTable === 'K1' ? 'KABİNET' : 'MASA ' + activeTable;
            document.getElementById('r-total').innerText = total.toFixed(2) + " AZN";
            document.getElementById('receipt-modal').classList.remove('hidden');
        }

        function closeModal() { document.getElementById('receipt-modal').classList.add('hidden'); }

        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString('az-AZ'); }, 1000);

        // START
        renderTableNav();
        changeCat('isti');
        masaSec(activeTable);
    </script>
</body>
</html>
