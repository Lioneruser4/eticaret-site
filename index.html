<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mələk AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #000000; --accent: #00d2ff; --text: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; height: 100vh; }
        
        header { padding: 15px; text-align: center; border-bottom: 1px solid #222; font-weight: bold; color: var(--accent); }
        
        #chat-box { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        .msg { max-width: 80%; padding: 12px 16px; border-radius: 15px; line-height: 1.5; word-wrap: break-word; }
        .ai { align-self: flex-start; background: #1a1a1a; border: 1px solid #333; }
        .user { align-self: flex-end; background: var(--accent); color: #000; font-weight: 500; }

        .input-area { padding: 15px; background: #111; display: flex; align-items: center; gap: 10px; border-top: 1px solid #222; }
        input { flex: 1; padding: 12px; border-radius: 25px; border: none; background: #222; color: white; outline: none; }
        
        .btns { display: flex; gap: 10px; }
        button { border: none; background: none; color: var(--accent); font-size: 22px; cursor: pointer; transition: 0.2s; }
        #mic-btn.active { color: #ff4b2b; animation: shake 0.5s infinite; }

        @keyframes shake { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<header>MƏLƏK AI — Xaliq Mustafayev</header>

<div id="chat-box">
    <div class="msg ai">Salam Xaliq Mustafayev. Mən Mələk, sənin köməkçinim. Buyur, nə istəsən həm yaza, həm də soruşa bilərsən.</div>
</div>

<div class="input-area">
    <input type="text" id="user-input" placeholder="Məssaj yazın..." autocomplete="off">
    <div class="btns">
        <button id="send-btn"><i class="fas fa-paper-plane"></i></button>
        <button id="mic-btn"><i class="fas fa-microphone"></i></button>
    </div>
</div>

<script>
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const micBtn = document.getElementById('mic-btn');

    // SƏS TANIMA (Dinləmə)
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = (SpeechRecognition) ? new SpeechRecognition() : null;
    if(recognition) {
        recognition.lang = 'az-AZ';
        recognition.onresult = (e) => {
            const text = e.results[0][0].transcript;
            processRequest(text);
        };
        recognition.onend = () => micBtn.classList.remove('active');
    }

    // SƏS SİNTEZİ (Danışma)
    function speak(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'az-AZ'; 
        utterance.rate = 1.0;
        window.speechSynthesis.speak(utterance);
    }

    // MESAJI EKRANA ƏLAVƏ ET
    function addMsg(text, type) {
        const div = document.createElement('div');
        div.className = `msg ${type}`;
        div.innerText = text;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    // SORĞUNU EMAL ET
    async function processRequest(text) {
        if (!text) return;
        addMsg(text, 'user');
        userInput.value = '';

        const lowerText = text.toLowerCase();
        let response = "";

        // ÖZƏL KOMANDALAR
        if (lowerText.includes("youtube")) {
            response = "Xaliq bəy, YouTube açılır.";
            window.open("https://www.youtube.com", "_blank");
        } else if (lowerText.includes("sahibin") || lowerText.includes("kim tərəfindən")) {
            response = "Mənim sahibim və yaradıcım Xaliq Mustafayevdir.";
        } else if (lowerText.includes("adın nə")) {
            response = "Mənim adım Mələkdir.";
        } else {
            // WIKIPEDIA / DATA API (Limitsiz məlumat)
            try {
                const res = await fetch(`https://tr.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(text)}`);
                const data = await res.json();
                response = data.extract || "Xaliq bəy, bu barədə məlumatım yoxdur, amma sizin üçün öyrənə bilərəm.";
            } catch {
                response = "İnternet bağlantısında problem var, Xaliq bəy.";
            }
        }

        setTimeout(() => {
            addMsg(response, 'ai');
            speak(response);
        }, 600);
    }

    // HADİSƏLƏR (Events)
    sendBtn.onclick = () => processRequest(userInput.value);
    userInput.onkeypress = (e) => { if(e.key === 'Enter') processRequest(userInput.value); };
    
    micBtn.onclick = () => {
        if(recognition) {
            recognition.start();
            micBtn.classList.add('active');
        } else {
            alert("Sizin brauzer səs dəstəkləmir.");
        }
    };
</script>

</body>
</html>
