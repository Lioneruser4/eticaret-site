<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geli≈ümi≈ü Profesyonel QR Kod Olu≈üturucu | GitHub Pages</title>
    
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    
    <style>
        /* Geli≈ümi≈ü Minimal Kurumsal CSS Framework */
        :root {
            --primary-color: #1a73e8; /* Mavi - Google/Kurumsal renk */
            --secondary-color: #555;
            --text-color: #3c4043;
            --bg-light: #f1f3f4; /* √áok a√ßƒ±k gri */
            --bg-card: #ffffff;
            --border-color: #dadce0;
            --box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-light);
            color: var(--text-color);
            margin: 0;
            padding: 40px 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .app-container {
            display: flex;
            gap: 30px;
            max-width: 1200px;
            width: 100%;
            margin: auto;
        }

        .card {
            background-color: var(--bg-card);
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--box-shadow);
            transition: box-shadow 0.3s;
        }
        
        /* Sol Panel: Kontroller */
        .controls-panel {
            flex: 1;
            min-width: 350px;
            max-width: 450px;
        }

        /* Saƒü Panel: QR Kod √ñnizleme */
        .preview-panel {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 500px;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            font-weight: 500;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        /* Form Elemanlarƒ± */
        label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--secondary-color);
        }

        input[type="text"], input[type="file"], select, input[type="color"] {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 15px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, select:focus, input[type="file"]:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Butonlar */
        button {
            width: 100%;
            padding: 12px;
            margin-top: 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            font-weight: 500;
        }

        button:hover {
            background-color: #1660c6;
        }

        /* QR Kod √ñnizleme Alanƒ± */
        #qrcode-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            min-height: 350px; 
            width: 100%;
        }

        #qrcode-container p {
            color: #9aa0a6;
            font-style: italic;
        }

        /* ƒ∞ndirme Butonu */
        #downloadBtn {
            margin-top: 20px;
            background-color: #34a853; /* Ye≈üil */
        }
        #downloadBtn:hover {
            background-color: #2e8b46;
        }

        /* SVG √ñzelle≈ütirme ve Animasyon CSS'i */
        /* QR kodun siyah noktalarƒ± (path'leri) */
        #qrcode-container svg path {
            fill: var(--qr-dark-color, #000000) !important; /* Varsayƒ±lan koyu renk */
            animation: slight-float 2s ease-in-out infinite alternate; 
            transform-origin: center center;
        }

        /* Y√ºklenen resim varsa, path dolgusunu pattern ile deƒüi≈ütir */
        .image-filled svg path {
            fill: url(#pattern-image) !important;
        }

        /* Animasyon Keyframes */
        @keyframes slight-float {
            0% { transform: translateY(0); }
            100% { transform: translateY(-1px); }
        }

        /* Responsive d√ºzenleme */
        @media (max-width: 900px) {
            .app-container {
                flex-direction: column;
            }
            .controls-panel, .preview-panel {
                max-width: 100%;
                min-width: auto;
            }
        }
    </style>
</head>
<body>

<div class="app-container">
    
    <div class="card controls-panel">
        <h1>‚öôÔ∏è QR Kod Ayarlarƒ±</h1>

        <label for="linkInput">Hedef Link / Metin:</label>
        <input type="text" id="linkInput" placeholder="https://www.orneksite.com" value="https://github.com/kullaniciadi">

        <label for="imageUpload">Dolgu Resmi (Siyah Kƒ±sƒ±mlar i√ßin):</label>
        <input type="file" id="imageUpload" accept="image/png, image/jpeg">
        <small style="color:red; display:block; margin-top:-10px; margin-bottom:15px;">**UYARI:** Dolgu resmi se√ßildiƒüinde renkler devre dƒ±≈üƒ± kalƒ±r.</small>

        <div class="grid-2">
            <div>
                <label for="darkColor">Koyu Renk:</label>
                <input type="color" id="darkColor" value="#1a73e8">
            </div>
            <div>
                <label for="lightColor">A√ßƒ±k Renk (Arka Plan):</label>
                <input type="color" id="lightColor" value="#ffffff" disabled>
            </div>
        </div>

        <div class="grid-2">
            <div>
                <label for="sizeSelect">Boyut (px):</label>
                <select id="sizeSelect">
                    <option value="256">256x256</option>
                    <option value="384">384x384</option>
                    <option value="512" selected>512x512</option>
                </select>
            </div>
            <div>
                <label for="errorSelect">Hata D√ºzeltme Seviyesi:</label>
                <select id="errorSelect">
                    <option value="L">D√º≈ü√ºk (L)</option>
                    <option value="M" selected>Orta (M)</option>
                    <option value="Q">Y√ºksek (Q)</option>
                    <option value="H">√áok Y√ºksek (H)</option>
                </select>
            </div>
        </div>
        
        <button onclick="generateQRCode()">QR Kodu Olu≈ütur / G√ºncelle</button>
    </div>

    <div class="card preview-panel">
        <h1>üñºÔ∏è QR Kod √ñnizleme</h1>
        
        <div id="qrcode-container">
            <p>Ayarlarƒ± girip 'Olu≈ütur'a tƒ±klayƒ±nƒ±z.</p>
        </div>

        <button id="downloadBtn" onclick="downloadQRCode()" disabled>PNG ƒ∞ndir</button>
    </div>

</div>

<script>
    const qrCodeContainer = document.getElementById('qrcode-container');
    const imageUpload = document.getElementById('imageUpload');
    const linkInput = document.getElementById('linkInput');
    const sizeSelect = document.getElementById('sizeSelect');
    const errorSelect = document.getElementById('errorSelect');
    const darkColorInput = document.getElementById('darkColor');
    const lightColorInput = document.getElementById('lightColor');
    const downloadBtn = document.getElementById('downloadBtn');

    // Ba≈ülangƒ±√ßta QR kodu olu≈ütur (√∂rnek g√∂stermek i√ßin)
    window.onload = function() {
        generateQRCode();
    };

    // Dinamik input deƒüi≈üikliklerini dinle
    document.querySelectorAll('.controls-panel input, .controls-panel select').forEach(element => {
        element.addEventListener('change', generateQRCode);
    });


    // QR Kodu olu≈üturma ve √∂zelle≈ütirme fonksiyonu
    function generateQRCode() {
        const link = linkInput.value.trim();
        const file = imageUpload.files[0];
        const size = parseInt(sizeSelect.value);
        const errorLevel = errorSelect.value;
        const darkColor = darkColorInput.value;
        const lightColor = lightColorInput.value;

        if (!link) {
            qrCodeContainer.innerHTML = '<p>L√ºtfen bir hedef link girin.</p>';
            downloadBtn.disabled = true;
            return;
        }

        // 1. Linki kontrol et ve 'https://' ekle
        let safeLink = link;
        if (!safeLink.match(/^(https?|ftp):\/\//i)) {
            safeLink = 'https://' + safeLink;
        }

        // 2. QR Kodu Olu≈ütur
        qrCodeContainer.innerHTML = ''; // √ñnceki kodu temizle

        // CSS deƒüi≈ükenini ayarla (renk veya resim dolgusunda kullanƒ±lacak)
        qrCodeContainer.style.setProperty('--qr-dark-color', darkColor);

        // qrcode.js Canvas'ƒ± kullanƒ±rsa indirilebilirlik i√ßin Canvas'ƒ± olu≈üturur, 
        // ancak biz √∂zelle≈ütirme i√ßin SVG olu≈üturmasƒ±nƒ± istiyoruz.
        new QRCode(qrCodeContainer, {
            text: safeLink,
            width: size,
            height: size,
            colorDark: darkColor,
            colorLight: lightColor,
            correctLevel: errorLevel
        });

        // ƒ∞ndirme butonunu etkinle≈ütir
        downloadBtn.disabled = false;


        // 3. Resim Dolgusu (Custom Image Fill)
        if (file) {
            qrCodeContainer.classList.add('image-filled');
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const imageDataUrl = e.target.result;
                const svgElement = qrCodeContainer.querySelector('svg');
                
                if (svgElement) {
                    const patternId = 'pattern-image';
                    
                    // √ñnceki pattern'leri temizle (G√ºncelleme i√ßin)
                    const existingDefs = svgElement.querySelector('defs');
                    if(existingDefs) existingDefs.remove();

                    // SVG Pattern olu≈üturma
                    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
                    const pattern = document.createElementNS('http://www.w3.org/2000/svg', 'pattern');
                    pattern.setAttribute('id', patternId);
                    pattern.setAttribute('width', '100%');
                    pattern.setAttribute('height', '100%');
                    pattern.setAttribute('patternContentUnits', 'objectBoundingBox');

                    const image = document.createElementNS('http://www.w3.org/2000/svg', 'image');
                    image.setAttribute('href', imageDataUrl);
                    image.setAttribute('x', '0');
                    image.setAttribute('y', '0');
                    image.setAttribute('width', '1');
                    image.setAttribute('height', '1');
                    image.setAttribute('preserveAspectRatio', 'xMidYMid slice'); 

                    pattern.appendChild(image);
                    defs.appendChild(pattern);
                    svgElement.prepend(defs); 
                }
            };
            reader.readAsDataURL(file);
        } else {
            // Resim yoksa, normal renk dolgusuna d√∂n
            qrCodeContainer.classList.remove('image-filled');
        }
    }

    // QR Kodunu PNG olarak indirme fonksiyonu
    function downloadQRCode() {
        const svgElement = qrCodeContainer.querySelector('svg');
        if (!svgElement) {
            alert('L√ºtfen √∂nce QR kodu olu≈üturun.');
            return;
        }

        // SVG'den veri URI'sini al
        const svgData = new XMLSerializer().serializeToString(svgElement);
        const svgBlob = new Blob([svgData], { type: "image/svg+xml;charset=utf-8" });
        const url = URL.createObjectURL(svgBlob);
        
        // Canvas olu≈ütur (PNG d√∂n√º≈ü√ºm√º i√ßin)
        const canvas = document.createElement('canvas');
        const size = parseInt(sizeSelect.value);
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');
        
        const img = new Image();
        img.onload = function() {
            ctx.drawImage(img, 0, 0);
            
            // PNG indirme linki olu≈ütur
            const a = document.createElement('a');
            a.download = 'professional_qr_code.png';
            a.href = canvas.toDataURL('image/png');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        };
        img.src = url;
    }
</script>

</body>
</html>
