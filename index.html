<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Video Kazan</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://app.adsgram.ai/js/adstg.js"></script>
    <style>
        body { background: #0e1621; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        .card { background: #17212b; border-radius: 20px; padding: 20px; border: 1px solid #2481cc; margin-bottom: 30px; }
        .balance { font-size: 50px; color: #31b545; font-weight: bold; }
        .btn-play { 
            background: #2481cc; color: white; border: none; padding: 20px; border-radius: 15px; 
            font-size: 20px; font-weight: bold; width: 100%; cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .btn-play:active { transform: scale(0.96); }
        #msg { color: #888; margin-top: 15px; font-size: 14px; }
    </style>
</head>
<body>

    <div class="card">
        <h3 id="u-name">KullanÄ±cÄ±</h3>
        <div class="balance" id="puan">0</div>
        <p style="color:#888; margin:0;">TOPLAM PUAN</p>
    </div>

    <button class="btn-play" onclick="reklamAc()">ðŸŽ¬ VÄ°DEO Ä°ZLE</button>
    <p id="msg">Sistem HazÄ±r</p>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const user = tg.initDataUnsafe?.user;
        const uID = user ? user.id : "guest";
        document.getElementById('u-name').innerText = user ? user.first_name : "Misafir";

        // KayÄ±tlÄ± PuanÄ± YÃ¼kle
        let puan = localStorage.getItem('p_' + uID) || "0";
        document.getElementById('puan').innerText = puan;

        // ADSGRAM BAÄžLANTISI (ID: int-20355)
        const AdController = window.Adsgram.init({ blockId: "int-20355" });

        function reklamAc() {
            const msg = document.getElementById('msg');
            msg.innerText = "Video aranÄ±yor...";
            
            tg.HapticFeedback.impactOccurred('medium');

            AdController.show().then((result) => {
                // Video baÅŸarÄ±yla WebView iÃ§inde izlendi ve kapatÄ±ldÄ±
                let pElement = document.getElementById('puan');
                let yeniPuan = parseInt(pElement.innerText) + 10;
                pElement.innerText = yeniPuan;
                localStorage.setItem('p_' + uID, yeniPuan);
                
                msg.innerText = "Tebrikler! +10 Puan KazandÄ±n.";
                tg.HapticFeedback.notificationOccurred('success');
            }).catch((err) => {
                // Video bulunamadÄ±ysa veya sistem onaylÄ± deÄŸilse
                console.error(err);
                msg.innerText = "Åžu an video yok, sonra tekrar dene.";
                tg.showAlert("Video ÅŸu an yÃ¼klenemedi. Adsgram panelinde 'Active' yazÄ±sÄ±nÄ± kontrol et.");
            });
        }
    </script>
</body>
</html>
