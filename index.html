<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Kazan</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://app.adsgram.ai/js/adstg.js"></script>
    <style>
        body { background: #0e1621; color: white; font-family: sans-serif; text-align: center; padding: 20px; }
        .user-card { background: #17212b; padding: 20px; border-radius: 15px; border: 1px solid #2481cc; margin-bottom: 20px; }
        .avatar { width: 70px; height: 70px; border-radius: 50%; border: 2px solid #2481cc; }
        .balance { font-size: 40px; color: #31b545; font-weight: bold; margin: 15px 0; }
        .btn-izle { background: #2481cc; color: white; border: none; padding: 18px; border-radius: 12px; font-size: 18px; font-weight: bold; width: 100%; cursor: pointer; }
        .btn-izle:active { background: #1c639d; }
    </style>
</head>
<body>

    <div class="user-card">
        <img id="u-photo" src="" class="avatar">
        <h3 id="u-name">YÃ¼kleniyor...</h3>
    </div>

    <div class="balance"><span id="bakiye">0</span> <small style="font-size: 14px;">PUAN</small></div>

    <button class="btn-izle" onclick="reklamGoster()">ðŸŽ¬ REKLAM Ä°ZLE KAZAN</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // KullanÄ±cÄ± Bilgileri
        const user = tg.initDataUnsafe?.user;
        const uID = user ? user.id : "guest";
        if (user) {
            document.getElementById('u-name').innerText = user.first_name;
            document.getElementById('u-photo').src = user.photo_url || "https://ui-avatars.com/api/?name=" + user.first_name;
        }

        // Bakiye YÃ¼kle
        let kayÄ±tlÄ± = localStorage.getItem('puan_' + uID) || "0";
        document.getElementById('bakiye').innerText = kayÄ±tlÄ±;

        // ADSGRAM BAÄžLANTISI (ID: 20353)
        // debug: true ekledik ki hata varsa ekrana yazsÄ±n
        const AdController = window.Adsgram.init({ blockId: "20353", debug: true });

        function reklamGoster() {
            // TIKLAMA TESTÄ°: Butona basÄ±ldÄ±ÄŸÄ±nÄ± anlamak iÃ§in mesaj veriyoruz
            tg.showAlert("Reklam aranÄ±yor... LÃ¼tfen bekleyin.");

            AdController.show().then((result) => {
                // BAÅžARILI
                let b = document.getElementById('bakiye');
                let yeni = parseInt(b.innerText) + 10;
                b.innerText = yeni;
                localStorage.setItem('puan_' + uID, yeni);
                tg.showAlert("Tebrikler! +10 Puan.");
            }).catch((err) => {
                // HATA VARSA BURASI Ã‡ALIÅžIR
                console.error(err);
                tg.showAlert("Hata oluÅŸtu veya reklam bulunamadÄ±. Detay: " + JSON.stringify(err));
            });
        }
    </script>
</body>
</html>
