<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Kazan - Video Ä°zle</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://app.adsgram.ai/js/adstg.js"></script>
    <style>
        body { background: #0e1621; color: white; font-family: 'Segoe UI', sans-serif; text-align: center; margin: 0; padding: 20px; }
        .user-card { background: #17212b; padding: 20px; border-radius: 20px; margin-bottom: 25px; border: 1px solid #2481cc; }
        .avatar { width: 70px; height: 70px; border-radius: 50%; border: 2px solid #2481cc; margin-bottom: 10px; }
        .balance-title { color: #888; font-size: 14px; margin-bottom: 5px; }
        .balance-value { font-size: 40px; color: #31b545; font-weight: bold; margin-bottom: 20px; }
        .btn-izle { background: #2481cc; color: white; border: none; padding: 18px 30px; border-radius: 15px; font-size: 20px; font-weight: bold; cursor: pointer; width: 100%; box-shadow: 0 4px 15px rgba(36, 129, 204, 0.3); }
        .btn-izle:active { transform: scale(0.97); }
        .footer-text { margin-top: 20px; font-size: 12px; color: #546675; }
    </style>
</head>
<body>

    <div class="user-card">
        <img id="user-photo" src="https://ui-avatars.com/api/?name=User" class="avatar">
        <h3 id="user-name" style="margin: 5px 0;">YÃ¼kleniyor...</h3>
        <p id="user-id" style="font-size: 11px; color: #6c7883; margin: 0;"></p>
    </div>

    <div class="balance-title">TOPLAM BAKÄ°YEN</div>
    <div class="balance-value"><span id="bakiye">0</span> <small style="font-size: 15px;">PUAN</small></div>

    <button class="btn-izle" onclick="reklamBaslat()">ðŸŽ¬ VÄ°DEO Ä°ZLE KAZAN</button>

    <p class="footer-text">Her video izleme size puan kazandÄ±rÄ±r!</p>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand(); // EkranÄ± tam boy yap

        // 1. KULLANICI BÄ°LGÄ°LERÄ°NÄ° OTOMATÄ°K AL (ID, Ä°SÄ°M, RESÄ°M)
        const user = tg.initDataUnsafe?.user;
        const userID = user ? user.id : "misafir";

        if (user) {
            document.getElementById('user-name').innerText = user.first_name + (user.last_name ? " " + user.last_name : "");
            document.getElementById('user-id').innerText = "ID: " + user.id;
            if (user.photo_url) {
                document.getElementById('user-photo').src = user.photo_url;
            }
        }

        // 2. ESKÄ° BAKÄ°YEYÄ° TELEFONDAN YÃœKLE (GÄ°R Ã‡IK YAPINCA SIFIRLANMAZ)
        let kayÄ±tlÄ±Bakiye = localStorage.getItem('bakiye_' + userID) || "0";
        document.getElementById('bakiye').innerText = kayÄ±tlÄ±Bakiye;

        // 3. ADSGRAM REKLAM AYARI (SENÄ°N ID'N EKLENDÄ°)
        const AdController = window.Adsgram.init({ blockId: "20352" });

        function reklamBaslat() {
            // ReklamÄ± aÃ§ar
            AdController.show().then((result) => {
                // REKLAM BAÅžARIYLA Ä°ZLENDÄ°
                let bakiyeElement = document.getElementById('bakiye');
                
                // KullanÄ±cÄ±ya vereceÄŸin puan (YarÄ±sÄ± sana dolar olarak, yarÄ±sÄ± ona puan olarak)
                let mevcutPuan = parseInt(bakiyeElement.innerText);
                let yeniPuan = mevcutPuan + 10; // Her video iÃ§in 10 puan
                
                // Ekranda gÃ¶ster ve telefona kaydet
                bakiyeElement.innerText = yeniPuan;
                localStorage.setItem('bakiye_' + userID, yeniPuan);
                
                tg.showAlert("Tebrikler! 10 puan kazandÄ±n. Bakiyen: " + yeniPuan);
            }).catch((result) => {
                // REKLAM Ä°ZLENMEDÄ° VEYA HATA OLDU
                tg.showAlert("Ã–dÃ¼l almak iÃ§in reklamÄ± sonuna kadar izlemelisin!");
            });
        }
    </script>
</body>
</html>
